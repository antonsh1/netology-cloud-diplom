# Дипломная работа «Облачное хранилище»

* Всё решение полностью (postgresql, back и front) запускается в контейнерах через запуск Docker-compose.yaml  
  * подключаться по ссылке http://localhost:8080
* Для авторизации можно использовать следующие логины (пароль у всех одинаковый password)  
    * Полный доступ: **main**  
    * Только загрузка: **upload**  
    * Только скачивание: **download**  

## Реализация

### 1. Авторизация  
 реализована встроенными средствами путем переопределения или создания различных объектов
 * Для настроек параметров CORS пришлось создать свой CORS фильтр, т.к. создание CorsConfigurationSource не приводило к необходимому результату
 * Для авторизации требуемым способом создан фильтр CustomFilter
 * Для авторизации по токену TokenSecurityContextRepository
 * Для формирования ответа с кодом 401 по неправильному логину и паролю TokenAuthenticationEntryPoint (в соответствии с [требованиями](https://github.com/netology-code/jd-homeworks/blob/master/diploma/CloudServiceSpecification.yaml) к методам)
 * Для очистки токена переопределен метод LogoutHandler

### 2. Основной функционал

Разделен на 
* контроллер  
Вызывает сервис (и валидация поступающих данных через spring)
* сервис  
Создан для преобразования форматов, проверки корректности данных и генерации исключений 
* файловый репозиторий  
работает непосредственно с файлами  

Для наполнения БД используется liquibase (DDL, DML)

### 3. Тесты

* Реализованы интеграционные тесты по списку требований.   
* Реализовано тестирование слоя сервиса через Mock  
* Для liquibase используется отдельный файл db.changelog-master-test.yaml с тестовыми данными БД для тестирования